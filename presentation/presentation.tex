% Copyright 2016 by Wang Kunzhen <wangkunzhen1993@gmail.com>.
%
% This is a latex template adapted from Till Tantau's Beamer template.
% It adds theme customizations for the convenience of users from the
% National University of Singapore. 
% 
% In principle, this file can be redistributed and/or modified under
% the terms of the GNU Public License, version 2.
%
% However, this file is supposed to be a template to be modified
% for your own needs. For this reason, if you use this file as a
% template and not specifically distribute it as part of a another
% package/program, I grant the extra permission to freely copy and
% modify this file as you see fit and even to delete this copyright
% notice. 

\documentclass[xcolor=dvipsnames]{beamer}

% There are many different themes available for Beamer. A comprehensive
% list with examples is given here:
% http://deic.uab.es/~iblanes/beamer_gallery/index_by_theme.html
% You can uncomment the themes below if you would like to use a different
% one:
%\usetheme{AnnArbor}
%\usetheme{Antibes}
%\usetheme{Bergen}
% \usetheme{Berkeley}
%\usetheme{Berlin}
%\usetheme{Boadilla}
% \usetheme{boxes}
%\usetheme{CambridgeUS}
%\usetheme{Copenhagen}
%\usetheme{Darmstadt}
%\usetheme{default}
\usetheme{Frankfurt}
%\usetheme{Goettingen}
%\usetheme{Hannover}
% \usetheme{Ilmenau}
% \usetheme{JuanLesPins}
% \usetheme{Luebeck}
% \usetheme{Madrid}
% \usetheme{Malmoe}
%\usetheme{Marburg}
% \usetheme{Montpellier}
% \usetheme{PaloAlto}
% \usetheme{Pittsburgh}
% \usetheme{Rochester}
% \usetheme{Singapore}
% \usetheme{Szeged}
% \usetheme{Warsaw}

\definecolor{nus-orange}{RGB}{239,124,0} 
\definecolor{nus-white}{RGB}{255,255,255}
\definecolor{nus-blue}{RGB}{0,61,124}
\definecolor{nus-black}{RGB}{0,0,0}

% Uncomment this section if you want the title background for each slide to be gradient like decaying from nus-orange to nus-white.
% \useoutertheme{shadow}
% \usepackage{tikz}
% \usetikzlibrary{shadings}
% \colorlet{titleleft}{nus-orange}
% \colorlet{titleright}{nus-orange!45!nus-white}
% \makeatletter
% \pgfdeclarehorizontalshading[titleleft,titleright]{beamer@frametitleshade}{\paperheight}{%
%   color(0pt)=(titleleft);
%   color(\paperwidth)=(titleright)}
% \makeatother
% End of gradient slide title effect.

\setbeamercolor{section in head/foot}{bg=nus-blue, fg=nus-white}
\setbeamercolor{subsection in head/foot}{bg=nus-blue, fg=nus-white}
\setbeamercolor{frametitle}{bg=nus-orange, fg=nus-white}
\setbeamercolor{title}{bg=nus-orange, fg=nus-white}
\setbeamercolor{alerted text}{fg=nus-orange}
\setbeamercolor{block title}{fg=nus-white}
\setbeamercolor{block body}{fg=nus-black}

\setbeamertemplate{theorems}[numbered]
\setbeamertemplate{propositions}[numbered]

\setbeamertemplate{bibliography item}{\insertbiblabel}

\setbeamertemplate{title page}[default][colsep=-4bp,rounded=true, shadow=true]

\usefonttheme[onlymath]{serif}
\setbeamertemplate{footline}[totalframenumber]

\addtobeamertemplate{navigation symbols}{}{
  \hspace{1em} \raisebox{1.35pt}{\usebeamerfont{footline}%
\insertframenumber/\inserttotalframenumber} }

\renewcommand\qedsymbol{$\blacksquare$}
% \setbeamertemplate{qed symbol}{$\blacksquare$}

\usepackage{braket}
\usepackage{multirow}
\usepackage{diagbox} % diagonal box in table
\usepackage{adjustbox} % allow tables to take up the space they need
\usepackage{graphicx} % allows figures to be inserted and scaled
\usepackage{listings} % allows for source code blocks
\usepackage{fancyvrb} % robust verbatim
\usepackage{fvextra} % robuster verbatim
\usepackage{siunitx} % allows SI units to be formatted
\usepackage{booktabs} % nice lines at top and bottom of tables

% \def\FancyVerbSpace{\textvisiblespace\kern0.07em}
% https://tex.stackexchange.com/questions/120207/customise-textvisiblespace
\newsavebox{\textvisiblespacebox}
\savebox{\textvisiblespacebox}{\texttt{a}}
\newcommand\vartextvisiblespace[1][\wd\textvisiblespacebox]{%
  \makebox[#1]{\kern.1em\rule{.4pt}{.3ex}%
  \hrulefill%
  \rule{.4pt}{.3ex}\kern.1em}%
}
\def\FancyVerbSpace{\vartextvisiblespace}


\usepackage[backend=biber, style=authortitle, isbn=false, doi=false, url=false, eprint=false]{biblatex}  
\addbibresource{../wiring.bib}
% \usepackage{hyperref} % hyperlinks
% \hypersetup{%
%   colorlinks=true,
%   linkcolor=purple,
%   urlcolor=blue
% }
\graphicspath{ {../images/} }

\newenvironment{Tabular}[1] % less cramped tables
{\def\arraystretch{1.75}\begin{tabular}{#1}}
{\end{tabular}}
\newenvironment{Array*}[1] % less cramped display mode arrays
{\def\arraystretch{1.75}\everymath={\displaystyle}\[\begin{array}{#1}}
{\end{array}\]}
\newenvironment{Array}[1] % less cramped display mode arrays
{\def\arraystretch{1.75}\everymath={\displaystyle}\begin{equation}\begin{array}{#1}}
{\end{array}\end{equation}}
\newenvironment{displaytable}[1] % environment for a simple inline table to present some information
{\vspace\abovedisplayskip\begin{center}\begin{tabular}{#1}}
{\end{tabular}\end{center}\vspace\belowdisplayskip}

\usepackage{mathtools}
\usepackage{tikz}
\usepackage{tikzscale} % include .tikz files with includegraphics and scale them
\usetikzlibrary{shapes, shapes.geometric, automata, positioning, arrows.meta, decorations.markings,decorations.pathreplacing, intersections, math, 3d, backgrounds, external}

\newcommand{\expandidx}[2]{%
  \expandafter#1\expandafter{\the\numexpr#2\relax}%
}

    \tikzset{%
      >={Stealth}, % makes the arrow heads bold
      node distance=3cm, % specifies the minimum distance between two nodes. Change if necessary.
      % style to apply some styles to each segment of a path
      on each segment/.style={
        decorate,
        decoration={
          show path construction,
          moveto code={},
          lineto code={
            \path [#1]
            (\tikzinputsegmentfirst) -- (\tikzinputsegmentlast);
          },
          curveto code={
            \path [#1] (\tikzinputsegmentfirst)
            .. controls
            (\tikzinputsegmentsupporta) and (\tikzinputsegmentsupportb)
            ..
            (\tikzinputsegmentlast);
          },
          closepath code={
            \path [#1]
            (\tikzinputsegmentfirst) -- (\tikzinputsegmentlast);
          },
        },
      },
      set mid arrow/.code={\pgfqkeys{/tikz/mid arrow}{#1}},
      set mid arrow={pos/.initial=.5, end/.initial={Stealth[length=6pt, sep=-3pt]}},
      mid arrow/.style={
        set mid arrow={#1},
        postaction={
          decorate,
          decoration={
            markings,
            mark=at position \pgfkeysvalueof{/tikz/mid arrow/pos}
                 with \arrow{\pgfkeysvalueof{/tikz/mid arrow/end}}
          }
        }
      },
      % simple black circle at node
      point/.style={circle,draw,inner sep=0pt,minimum size=3pt,fill=black},
      % nonclassical causation
      classbox/.style={rectangle, draw, line width=1pt},
      nclassbox/.style={rectangle, double, draw, rounded corners},
      classinfl/.style={-, line width=1pt},
      nclassinfl/.style={double},
      % coin with label and colours
      % TODO DOES NOT WORK
      set coin/.code={\pgfqkeys{/tikz/coin}{#1}},
      set coin={bg/.initial=black, fg/.initial=white},
      coin/.style={
        set coin={#1},
        postaction={
          circle,draw=\pgfkeysvalueof{/tikz/coin/fg},
          text=\pgfkeysvalueof{/tikz/coin/fg},
          fill=\pgfkeysvalueof{/tikz/coin/bg}
        }
      }
    }




\tikzset{%
  % simple black circle at node
  point/.style={circle,draw,inner sep=0pt,minimum size=3pt,fill=black},
  % coin with label and colours
  % TODO DOES NOT WORK
  set coin/.code={\pgfqkeys{/tikz/coin}{#1}},
  set coin={bg/.initial=black, fg/.initial=white},
  coin/.style={
    set coin={#1},
    postaction={
      circle,draw=\pgfkeysvalueof{/tikz/coin/fg},
      text=\pgfkeysvalueof{/tikz/coin/fg},
      fill=\pgfkeysvalueof{/tikz/coin/bg}
    }
  }
}

\RequirePackage{luatex85}
% Default preamble
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\usepgfplotslibrary{groupplots}
\usepgfplotslibrary{polar}
\usepgfplotslibrary{smithchart}
\usepgfplotslibrary{statistics}
\usepgfplotslibrary{dateplot}
\usepgfplotslibrary{ternary}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{backgrounds}
\usepgfplotslibrary{patchplots}
\usepgfplotslibrary{fillbetween}
\pgfplotsset{%
  layers/standard/.define layer set={%
    background,axis background,axis grid,axis ticks,axis lines,axis tick labels,pre main,main,axis descriptions,axis foreground%
    }{grid style= {/pgfplots/on layer=axis grid},%
    tick style= {/pgfplots/on layer=axis ticks},%
    axis line style= {/pgfplots/on layer=axis lines},%
    label style= {/pgfplots/on layer=axis descriptions},%
    legend style= {/pgfplots/on layer=axis descriptions},%
    title style= {/pgfplots/on layer=axis descriptions},%
    colorbar style= {/pgfplots/on layer=axis descriptions},%
    ticklabel style= {/pgfplots/on layer=axis tick labels},%
    axis background@ style={/pgfplots/on layer=axis background},%
    3d box foreground style={/pgfplots/on layer=axis foreground},%
  },
}

    \usepackage{mleftright} % fix spacing issues in \left and \right
    \mleftright % rename left/right -> mleft/mright

    % analysis and calculus
    \DeclareMathOperator*{\argmin}{argmin}
    \DeclareMathOperator*{\argmax}{argmax}
    \newcommand{\norm}[1]{\mathop{}\left\lVert#1\right\rVert}
    \newcommand{\abs}[1]{\mathop{}\left\lvert#1\right\rvert}
    \newcommand{\indif}{{\mathop{}\!\mkern3mu\mathchar'26\mkern-12mu \mathrm{d}}}
    \newcommand{\Dif}{\mathop{}\!\mathrm{D}} % Difference operator
    \newcommand{\dif}{\mathop{}\!\mathrm{d}} % differential d
    \newcommand{\dintv}[2]{\mathopen\{#1,\ldots,#2\mathclose\}}
    \DeclarePairedDelimiterX{\ocintv}[2]{(}{]}{#1,#2}
    \DeclarePairedDelimiterX{\cointv}[2]{[}{)}{#1,#2}
    \DeclarePairedDelimiterX{\ccintv}[2]{[}{]}{#1,#2}
    \DeclarePairedDelimiterX{\oointv}[2]{(}{)}{#1,#2}

    % CS, discrete maths, algebra
    \DeclareMathSymbol{\lneg}{\mathord}{symbols}{"18} % tildes for negation
    \newcommand{\st}{\mathrel{:}} % 'such that'
    \newcommand{\?}{\mathrel{?}} % ternary operator
    \newcommand{\concat}{\mathbin{\Vert}} % string concatenation operator
    \newcommand{\Mod}{~\mathbf{mod}~} % for mod operator
    \newcommand{\Div}{~\mathbf{div}~} % for div operator
    \newcommand{\Rem}{~\mathbf{rem}~} % for rem operator
    \newcommand{\Z}{\mathbb{Z}} % for integers
    \newcommand{\R}{\mathbb{R}} % for reals
    \newcommand{\C}{\mathbb{C}} % for complex
    \newcommand{\ceil}[1]{\left\lceil#1\right\rceil} % enables \ceil{} for ceil delimiter
    \newcommand{\floor}[1]{\left\lfloor#1\right\rfloor} % enables \floor{} for floor delimiter

    % linear algebra
    \newcommand{\Lin}[1]{\mathbb{L}\left(#1\right)}
    \newcommand{\tpose}{\mathrm{T}}
    \newcommand{\cvec}[1]{\boldsymbol{\mathbf{#1}}}    % column vectors
    \newcommand{\rvec}[1]{\boldsymbol{\mathbf{#1}}^\tpose} % row vectors (transposed from column vectors)
    \newcommand{\bvec}[1]{\hat{\boldsymbol{\mathbf{#1}}}} % basis vectors
    \newcommand{\matr}[2][]{\left[\mathbf{#2}#1\right]} % matrices
    \newcommand{\inner}[2]{\left\langle#1,#2\right\rangle} % inner product
    % \newcommand{\dim}{\rm dim} % dimension

    % probability and statistics
    \newcommand{\rv}[1]{\boldsymbol{\mathbf{#1}}} % random variable
    \newcommand{\E}{\mathbb{E}} % expectation
    \newcommand{\angleb}[1]{\left\langle #1 \right\rangle} % physicist's notation for mean
    \newcommand{\Var}{\mathrm{Var}} % variance
    \newcommand{\indep}{\mathrel{\perp \!\!\! \perp}} % independence symbol
    \newcommand{\indic}[1]{\delta{\left\{#1\right\}}} % indicator function
    \newcommand*\markov{\mathrel{\ooalign{\hidewidth$\circ$\hidewidth\cr$-$\cr}}} % Markov chain

    % quantum physics
    \newcommand{\Tr}[2][]{\mathop{\mathrm{Tr}#1}\left[ #2 \right]} % enables Trace operator
    \newcommand{\Trdist}[2]{\mathop{}\Delta_\mathrm{Tr}\left(#1, #2\right)}
    \newcommand{\Hs}{\mathcal{H}} % enables H for Hilbert space

    % category theory
    % \newcommand{\hom}{\mathrm{hom}} % collection of morphisms in a category
    \newcommand{\Hom}{\mathrm{Hom}} % collection of between two objects
    \newcommand{\ob}{\mathrm{ob}} % collection of objects
    \newcommand{\id}{\mathrm{id}} % identity morphism

    \newcommand{\sM}{\mathcal{M}}
    \newcommand{\sN}{\mathcal{N}}
    \newcommand{\sS}{\mathcal{S}}
    \newcommand{\sK}{\mathcal{K}}
    \newcommand{\sT}{\mathcal{T}}

    \newcommand{\sA}{\mathcal{A}}
    \newcommand{\sB}{\mathcal{B}}
    \newcommand{\sC}{\mathcal{C}}
    \newcommand{\sD}{\mathcal{D}}
    \newcommand{\sP}{\mathcal{P}}
    \newcommand{\sV}{\mathcal{V}}
    \newcommand{\sW}{\mathcal{W}}
    \newcommand{\sX}{\mathcal{X}}
    \newcommand{\sY}{\mathcal{Y}}
    \newcommand{\sZ}{\mathcal{Z}}
    \newcommand{\cE}{\mathcal{E}}
    \newcommand{\cF}{\mathcal{F}}

    \newcommand{\cP}{\mathbb{P}}

    \newcommand{\rA}{\mathrm{A}}
    \newcommand{\rB}{\mathrm{B}}
    \newcommand{\rX}{\mathrm{X}}
    \newcommand{\rY}{\mathrm{Y}}

    \newcommand{\crv}[1]{\mathsf{#1}}
    \newcommand{\proj}[2][]{{[#2]}_{#1}}
    \newcommand{\LCxE}[1]{\mathrm{LCxE}\left(#1\right)}
    \newcommand{\meas}{\rm meas}
    \newcommand{\perm}{\rm perm}
    \newcommand{\pe}{\rm pe}
    \newcommand{\pa}{\rm pa}
    \newcommand{\ir}{\rm ir}
    \newcommand{\leakir}{\mathrm{leak}_{\ir}}
    \newcommand{\auth}{\rm auth}
    \newcommand{\key}{\rm key}
    \newcommand{\rob}{\rm rob}
    \newcommand{\cor}{\rm cor}
    \newcommand{\secur}{\rm sec}
    \newcommand{\erob}[1][]{\epsilon^{\rob}_{#1}}

    \newcommand{\HC}{\mathrm{HC}}
    \newcommand{\MC}{\mathrm{MC}}

    \newcommand{\Ls}{\mathcal{L}}
    \newcommand{\Qs}{\mathcal{Q}}
    \newcommand{\NSs}{\mathcal{NS}}
    \newcommand{\PR}{\mathrm{PR}}
    \newcommand{\sWB}{\mathcal{WB}}
    \newcommand{\compatstates}[3][]{\hat{\mathcal{P}}#1(#2,#3)}
    \newcommand{\proto}[2][\ell]{\mathfrak{P}_{#2, #1}}
    \newcommand{\qproto}[2][\ell]{\tilde{\mathfrak{P}}_{#2, #1}}
    \newcommand{\prin}[1][p]{#1_{\mathrm{in}}}
    \newcommand{\behav}[2]{\mathbb{P}\left[#1, #2\right]}
    \newcommand{\sk}{\rm sk}
    \newcommand{\DW}{\rm DW}
    \newcommand{\std}{\rm std}
    \newcommand{\crit}{\rm crit}


\setbeameroption{hide notes} % Only slides
% \setbeameroption{show only notes} % Only notes
% \setbeameroption{show notes on second screen=right} % Both
\setbeamertemplate{note page}[plain]

\title{Device-Independent Quantum Cryptography and Nonlocal Distillation}

\author{John Khoo}

\institute[National University of Singapore]
{
  Department of Electrical and Computer Engineering \\ \& Department of Computer Science \\
  National University of Singapore
}

\titlegraphic{
  \includegraphics[width=2cm]{nus-logo}
}

\date{\today}

% Uncomment this, if you want the table of contents to pop up at
% the beginning of each subsection:
\AtBeginSubsection[]
{
  \begin{frame}<beamer>{Outline}
    \tableofcontents[currentsection,currentsubsection]
  \end{frame}
}

\begin{document}

\begin{frame}
  \titlepage
\end{frame}

\section*{Introduction}
\begin{frame}{Quantum Key Distribution (QKD)}
  \begin{itemize}[<+->]
    \item Quantum processes are \alert{fundamentally indeterministic}
    \item Data from quantum processes can be \alert{guaranteed to be private}
    \item We can \alert{distribute unconditionally secure keys} using such data
  \end{itemize}
\end{frame}

\note{
  Like good engineers, the first thing we try to do is figure out how we can use this.

  The security of these keys is not dependent on the computational power of an adversary. Instead, it is proved that the process of generating the keys does not leak any information whatsoever about the keys to an adversary, so that he can do little better than randomly guessing the key.

  Unconditional security can be achieved by the two parties meeting up to agree on a common key, but it is impossible to do remotely over an untrusted medium, except using QKD. This explains the D in QKD: it is not just about establish highly secure keys, but doing so in a distributed fashion, without requiring the cumbersome trusted channel of physical contact.
}

\begin{frame}[fragile]{Unconditional Security}

  \only<1-2>{
    \begin{center}
      Alphabet of \(q\) letters: \EscVerb*{ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 }
    \end{center}

    \begin{center}
      \begin{tabular}{c|c}
            &     \EscVerb*{WE WILL ATTACK AT 1200} \\
        \(+_q\) & \EscVerb*{EEEEEEEEEEEEEEEEEEEEEE} \\ \hline
        \(=\)   & \EscVerb*{0ID0MPPDEXXEGODEXD5644} \\
      \end{tabular}
    \end{center}

    \uncover<2>{
      \begin{center}
        \begin{tabular}{c|c}
            & \EscVerb*{0ID0MPPDEXXEGODEXD5644} \\
          \(-_q\) & \EscVerb*{FFFFFFFFFFFFFFFFFFFFFF} \\ \hline
          \(=\)   & \EscVerb*{VD9VHKK9 SS BJ9 S901ZZ} \\
        \end{tabular}
      \end{center}

      \begin{center}
        \begin{tabular}{c|c}
            & \EscVerb*{0ID0MPPDEXXEGODEXD5644} \\
          \(-_q\) & \EscVerb*{GGGGGGGGGGGGGGGGGGGGGG} \\ \hline
          \(=\)   & \EscVerb*{UC8UGJJ89RR9AI89R8Z0YY} \\
        \end{tabular}
      \end{center}
    }
  }

  \only<3-5>{

    \begin{center}
      \begin{tabular}{c|c}
            & \EscVerb*{WE WILL ATTACK AT 1200} \\
        \(+_q\) & \EscVerb*{7LP3CNZEI AALJAAUUSXY3} \\ \hline
        \(=\)   & \EscVerb*{SPOOKY DISTANT ACTIONS} \\
      \end{tabular}
    \end{center}

    \uncover<4-5>{
      \begin{center}
        \begin{tabular}{c|c}
            &       \EscVerb*{SPOOKY DISTANT ACTIONS} \\
          \(-_q\) & \EscVerb*{KQ3O8FAD4DI7OL87DR2KNG} \\ \hline
          \(=\)   & \EscVerb*{I WANT APPLE ICE CREAM} \\
        \end{tabular}
      \end{center}
    }

    \uncover<5>{
      \begin{center}
        \begin{tabular}{c|c}
            & \EscVerb*{SPOOKY DISTANT ACTIONS} \\
          \(-_q\) & \EscVerb*{7LP3CNZEI AALJAAUUTUY3} \\ \hline
          \(=\)   & \EscVerb*{WE WILL ATTACK AT 0500} \\
        \end{tabular}
      \end{center}
    }

  }
\end{frame}

\begin{frame}{Device-Independent Quantum Key Distribution (DIQKD)}
  \begin{itemize}[<+->]
    \item QKD \alert{strictly necessary} for establishing unconditionally secure keys over untrusted channel
    \item However, many \alert{assumptions} about devices needed for QKD security
    \item Cannot rule out \alert{all possible device flaws}
    \item DIQKD:\ certify security using \alert{device statistics} from \alert{Bell tests}
  \end{itemize}
\end{frame}

\note{
  While our protocols may be secure in theory, the devices we choose to implement them may violate the assumptions of our proofs.

  The behaviour is fully parametrised by a small set of easily measurable variables.
}

\begin{frame}{Nonlocal Distillation}
  \begin{itemize}[<+->]
    \item \emph{Wiring}: combining multiple Bell test devices using classical local processing
    \item Will produce different statistics
    \item \alert{Distillation}: achieving a superior resource from wiring of inferior resources
  \end{itemize}
\end{frame}

\begin{frame}{Results}
  \begin{itemize}[<+->]
    \item Explored \alert{definitions of security}
    \item Analytic and computational \alert{descriptions for wirings}
    \item Main result: simple wirings \alert{cannot help}
    \item Preliminary work towards \alert{optimising key rates over wirings}
  \end{itemize}
\end{frame}

\begin{frame}{Outline}
  \tableofcontents
\end{frame}

\section{Foundations}

\subsection{Nonlocality}

\begin{frame}{Bell Tests}
  \begin{onlyenv}<1>
    \begin{figure}
      \centering
      \begin{tikzpicture}
        \tikzmath{\rows = 5; \cols = 3; \intra = 2; \inter = 2; \rheight = 1;
        \nrowv = \rheight+\rheight; \theight = \rows*\rheight; 
        \colm = \cols-1; \ncolh = \inter+\intra; \twidth = \colm*\inter+\cols*\intra;}
        \draw (0,0) node {Alice} ++(\intra,0) node {Bob} ++(\inter,0) node {Alice} ++(\intra,0) node {Bob} ++(\inter,0) node {Alice} ++(\intra,0) node {Bob};
        \foreach \v in {\rheight,\nrowv,...,\theight} {
          \foreach \h in {0,\ncolh,...,\twidth} {
            \tikzmath{int \a, \b, \x, \y;
              \a = random(0,1); \b = random(0,1); \x = random(0,1); \y = random(0,1);
              if \a == 1 then { let \aval = H; } else { let \aval = T; };
              if \b == 1 then { let \bval = H; } else { let \bval = T; };
              if \x == 1 then { let \afg = black; let \abg = white; } else { let \afg = white; let \abg = black; };
              if \y == 1 then { let \bfg = black; let \bbg = white; } else { let \bfg = white; let \bbg = black; };
            }

            % TODO DOES NOT WORK
            % \draw (\h, \v) node[coin={bg = \abg, fg = \afg}] {\aval} ++(\intra,0) node[coin={bg = \bbg, fg = \bfg}] {\bval};
            \draw (\h, \v) node[circle,draw=\afg, text=\afg, fill=\abg,] {\aval} ++(\intra,0) node[circle,draw=\bfg, text=\bfg, fill=\bbg, ] {\bval}; 
          }
        }

        \tikzmath{\ilineh = \intra+0.5*\inter; \nlineh = \ilineh+\intra+\inter;}
        \foreach \h in {\ilineh, \nlineh} {
          \path[draw=black] (\h, -0.5*\rheight) -- (\h, \theight+0.5*\rheight);
        }
      \end{tikzpicture}
      \caption{Uncorrelated statistics}%
    \end{figure}
  \end{onlyenv}

  \begin{onlyenv}<2>
    \begin{figure}
      \centering
      \begin{tikzpicture}
        \tikzmath{\rows = 5; \cols = 3; \intra = 2; \inter = 2; \rheight = 1;
        \nrowv = \rheight+\rheight; \theight = \rows*\rheight; 
        \colm = \cols-1; \ncolh = \inter+\intra; \twidth = \colm*\inter+\cols*\intra;}
        \draw (0,0) node {Alice} ++(\intra,0) node {Bob} ++(\inter,0) node {Alice} ++(\intra,0) node {Bob} ++(\inter,0) node {Alice} ++(\intra,0) node {Bob};
        \foreach \v in {\rheight,\nrowv,...,\theight} {
          \foreach \h in {0,\ncolh,...,\twidth} {
            \tikzmath{int \a, \b, \x, \y;
              \x = random(0,1); \y = random(0,1);
              if \x == 1 then { let \afg = black; let \abg = white; let \aval = H; } else { let \afg = white; let \abg = black; let \aval = T; };
              if \y == 1 then { let \bfg = black; let \bbg = white; let \bval = H; } else { let \bfg = white; let \bbg = black; let \bval = T; };
            }

            \draw (\h, \v) node[circle,draw=\afg, text=\afg, fill=\abg,] {\aval} ++(\intra,0) node[circle,draw=\bfg, text=\bfg, fill=\bbg, ] {\bval}; 
          }
        }

        \tikzmath{\ilineh = \intra+0.5*\inter; \nlineh = \ilineh+\intra+\inter;}
        \foreach \h in {\ilineh, \nlineh} {
          \path[draw=black] (\h, -0.5*\rheight) -- (\h, \theight+0.5*\rheight);
        }
      \end{tikzpicture}
      \caption{Locally correlated statistics}%
    \end{figure}
  \end{onlyenv}

  \begin{onlyenv}<3>
    \begin{figure}
      \centering
      \begin{tikzpicture}
        \tikzmath{\rows = 5; \cols = 3; \intra = 2; \inter = 2; \rheight = 1;
        \nrowv = \rheight+\rheight; \theight = \rows*\rheight; 
        \colm = \cols-1; \ncolh = \inter+\intra; \twidth = \colm*\inter+\cols*\intra;}
        \draw (0,0) node {Alice} ++(\intra,0) node {Bob} ++(\inter,0) node {Alice} ++(\intra,0) node {Bob} ++(\inter,0) node {Alice} ++(\intra,0) node {Bob};
        \foreach \v in {\rheight,\nrowv,...,\theight} {
          \foreach \h in {0,\ncolh,...,\twidth} {
            \tikzmath{int \a, \b, \x, \y;
              \x = random(0,1); \y = random(0,1); \o = random(0,1);
              if \o == 1 then { let \aval = H; let \bval = T; } else { let \aval = T; let \bval = H; };
              if \x == 1 then { let \afg = black; let \abg = white; } else { let \afg = white; let \abg = black; };
              if \y == 1 then { let \bfg = black; let \bbg = white; } else { let \bfg = white; let \bbg = black; };
              if \x * \y != 1 then { let \bval = \aval; };
            }

            \draw (\h, \v) node[circle,draw=\afg, text=\afg, fill=\abg,] {\aval} ++(\intra,0) node[circle,draw=\bfg, text=\bfg, fill=\bbg, ] {\bval}; 
          }
        }

        \tikzmath{\ilineh = \intra+0.5*\inter; \nlineh = \ilineh+\intra+\inter;}
        \foreach \h in {\ilineh, \nlineh} {
          \path[draw=black] (\h, -0.5*\rheight) -- (\h, \theight+0.5*\rheight);
        }
      \end{tikzpicture}
      \caption{Nonlocally correlated statistics}%
    \end{figure}
  \end{onlyenv}
\end{frame}

\note{ Alice and Bob each have a jar of black coins and a jar of white coins. They play a game where, in each round, they take a coin from each jar, choose one coin, and flip it. }

\begin{frame}{Nonlocal Statistics}
  \begin{itemize}[<+->]
    \item Alice: input \(x\), output \(a\); Bob: input \(y\), output \(b\)
    \item Full statistics: \emph{behaviour} \(p(ab|xy)\) (aka \emph{state}/\emph{box})
    \item Must fulfill \emph{no-signalling conditions}
      \begin{gather*}
        \sum_b p(ab|xy) = p(a|xy) = p(a|x)\;\forall a,x,y \\
        \sum_a p(ab|xy) = p(b|xy) = p(b|y)\;\forall b,x,y
      \end{gather*}
    \item \emph{Setting}: \((i_A, o_A; i_B, o_B)\)
      \[ x \in \dintv{1}{i_A} \qquad a \in \dintv{1}{o_A} \]
      \[ y \in \dintv{1}{i_B} \qquad b \in \dintv{1}{o_B} \]
  \end{itemize}
\end{frame}

\begin{frame}{Nonlocal Behaviours}
  \begin{itemize}[<+->]
    \item \emph{Local set} \(\Ls\): \(p(ab|xy) = \int P_{\Lambda}(\lambda) p_{\lambda}(a|x)p_{\lambda}(b|y) \dif{\lambda} \)
    \item \emph{Quantum set} \(\Qs\): \(p(ab|xy) = \Tr{ \rho_{AB} \left(M_{a|x} \otimes N_{b|y}\right) }\)
    \item \emph{No-signalling set} \(\NSs\) defined by no-signalling conditions
    \item \(\Ls \subsetneq \Qs \subsetneq \NSs\)
  \end{itemize}
\end{frame}

\subsection{DIQKD}

\begin{frame}{DIQKD Security}
  \begin{itemize}[<+->]
    \item \(\rho_{\crv{A}^n\crv{X}^n \crv{B}^n\crv{Y}^n E^n}\): Alice--Bob--Eve ccq state after \(n\) Bell tests
          \[ \sum_{\cvec{a}^n\cvec{b}^n \cvec{x}^n\cvec{y}^n} \begin{aligned}[c]
          & \prin^n(\cvec{x}^n,\cvec{y}^n) p^n(\cvec{a}^n\cvec{b}^n|\cvec{x}^n\cvec{y}^n) \proj[\crv{A}^n\crv{X}^n \crv{B}^n\crv{Y}^n]{\cvec{a}^n\cvec{x}^n \cvec{b}^n\cvec{y}^n} \otimes \\
            & \rho_{E^n|\cvec{a}^n\cvec{b}^n\cvec{x}^n\cvec{y}^n}
          \end{aligned} \]
    \item \emph{Asymptotic key rate} of a sequence of states \(\{\rho^n\}\)
      \[ r(\proto{\Omega}, \{\rho^n\}) = \lim_{n\to\infty} \frac{\ell_n - L_{\Omega}(\prin^n)}{n} \]
    \item \(L_{\Omega}(\prin^n)\): minimum cost for generating \(\prin^n\) (\alert{novel definition})
    \item Dependent on protocol in general
    \item Upper bounded by \emph{Wyner common information} if iid
  \end{itemize}
\end{frame}
\note{ \(\prin^n\) is typically assumed to be independent but we want to probe fundamental limits. Dependent inputs can avoid sifting factor (though this is multiplicative, not additive). This constrains the possible \(\prin^n\), since it must be generated with asymptotically zero error, or else the error needs to be accounted for in some other way. Protocols may allow recovery of input secrecy, so \(L_{\Omega}\) may be zero for dependent inputs. }

\begin{frame}{Security from Behaviours}
    \begin{itemize}[<+->]
      \item Optimise over \emph{states compatible with classical data} \(\compatstates[^n]{p}{\prin[p^n]}\)
        \begin{itemize}
          \item Average behaviour matches \(p\)
          \item Input distribution is \(\prin[p^n]\)
          \item Generated by measurements on qqq states 
        \end{itemize}
      \item Well-established methods for reducing to iid
      \item Focus on \emph{iid secret key capacity}
        \[ C_{\sk}^{\otimes}(p) = \sup_{\proto{\Omega}} \sup_{\prin} \inf_{\substack{\rho : \\ \rho \in \compatstates{p}{\prin}}} r(\proto{\Omega}, \{\rho^{\otimes{n}}\}) \]
        over asymptotically secure protocols \(\proto{\Omega}\)
    \end{itemize}
\end{frame}

\section{Wirings}

\subsection{Wiring Distributions}

\begin{frame}{Local Operations and Shared Randomness\setcounter{footnote}{0}\footfullcite{NonclassicalCausation} (LOSR)}
  \begin{onlyenv}<1-3>
    \begin{itemize}[<+->]
      \item Local operation: take overall input, generate physical input, generate overall output from physical output
        \[ p'(a|x) = \sum_{a_0 x_0} p_o(a|x_0 a_0 x) p(a_0|x_0) p_i(x_0|x) \]
      \item Combine into a map obeying \emph{no-retrocausation}
        \[ \sum_a \chi_{A|\lambda}(ax_0|a_0x) = \sum_a p_o(a|x_0 a_0 x) p_i(x_0|x) = p_i(x_0|x) \]
      \item Combine with other party using \emph{shared randomness}
        \begin{align*}
          \chi(abx_0y_0|a_0b_0xy) &\coloneqq \sum_{\lambda} P_{\Lambda}(\lambda) \chi_{A|\lambda}(ax_0|a_0x) \chi_{B|\lambda}(by_0|b_0y) \\
          p'(ab|xy) &= \sum_{abxy} \chi(abx_0y_0|a_0b_0xy) p(a_0b_0|x_0y_0)
        \end{align*}
    \end{itemize}
  \end{onlyenv}
  \begin{onlyenv}<4->
    \begin{columns}
      \begin{column}[c]{0.3\linewidth}
        \centering
        \includegraphics{behav.tikz}
      \end{column}
      \begin{column}[c]{0.7\linewidth}
        \centering
        \includegraphics{losr.tikz}
      \end{column}
    \end{columns}
  \end{onlyenv}
\end{frame}

\begin{frame}{Wirings}
  \begin{onlyenv}<1-3>
    \begin{itemize}[<+->]
      \item Generalise to multiple boxes: \emph{wiring distributions} \(\chi\)
        \begin{align*}
          p'(ab|xy) &\coloneqq \sum_{\cvec{a}^c\cvec{b}^c\cvec{x}^c\cvec{y}^c} \chi(ab\cvec{x}^c\cvec{y}^c|\cvec{a}^c\cvec{b}^cxy) p^c(\cvec{a}^c\cvec{b}^c|\cvec{x}^c\cvec{y}^c)\label{eqn:jwirdistdef} \\
          \chi(ab\cvec{x}^c\cvec{y}^c|\cvec{a}^c\cvec{b}^cxy) &\coloneqq \sum_{\lambda} P_{\Lambda}(\lambda) \chi_{A|\lambda}(a\cvec{x}^c|\cvec{a}^cx) \chi_{B|\lambda}(b\cvec{y}^c|\cvec{b}^cy)
        \end{align*}
      \item \emph{Marginal wirings} must obey \emph{no-retrocausation} conditions:
        \begin{align*}
          \chi_{A|\lambda}(\cvec{x}^j|\cvec{a}^cx) &= \chi_{A|\lambda}(\cvec{x}^j|\cvec{a}^{j-1}x),\,\forall j \in \dintv{1}{c} \\
          \chi_{B|\lambda}(\cvec{y}^j|\cvec{b}^cy) &= \chi_{B|\lambda}(\cvec{y}^j|\cvec{b}^{j-1}y),\,\forall j \in \dintv{1}{c}
        \end{align*}
      \item No-retrocausation requires marginal wirings to be sequences of stochastic maps
        \[ \chi_{A|\lambda}(a\cvec{x}^c|\cvec{a}^cx) = \chi_{A|\lambda}(a|\cvec{x}^c\cvec{a}^{c}x) \prod_{j=1}^c \chi_{A|\lambda}(x_j|\cvec{x}^{j-1}\cvec{a}^{j-1}x) \]
    \end{itemize}
  \end{onlyenv}
  \begin{onlyenv}<4->
    \begin{center}
      \includegraphics[height=0.85\textheight]{wiring.tikz}
    \end{center}
  \end{onlyenv}
\end{frame}

\begin{frame}{Structure of the Space of Wirings}
  \begin{itemize}[<+->]
    \item In each round, \emph{some} concrete sequence of mappings is be executed
    \item Each round consists of randomly selecting some permutation of deterministic marginal wirings for each of the parties
    \item Effect of random selection is convex combination
      \begin{theorem}[Fine's Theorem for Wirings]
        The set of marginal wirings \(\sW_c\) forms a polytope, whose vertices are the set of deterministic marginal wirings obeying the no-retrocausation relations \(\sW_{D,c}\). All \(n\)-partite wirings are then elements of the polytope generated by the vertices \(\sW_{D,c}^n\).
      \end{theorem}
  \end{itemize}
\end{frame}

\subsection{Computational Descriptions}

\begin{frame}{Wiring Functions}
  \begin{itemize}[<+->]
    \item Deterministic maps are functions
      \begin{align*}
        x_j &= W^{(j)}_{A}(\cvec{x}^{j-1}, \cvec{a}^{j-1}, x),\,j \in \dintv{1}{c} \\
          a &= T_{A}(\cvec{x}^{c}, \cvec{a}^{c}, x)
      \end{align*}
    \item \(\#\) of deterministic marginal wirings by combinatorics:
      \[ \exp_{o_A}(i_A^c o_A^c) \prod_{j=1}^c \exp_{i_A}(i_A^{j} o_A^{j-1}) \]
    \item Expressing as Karnaugh maps reveals redundancy, reduces to
      \[ \exp_{o_A}(i_A o_A^c) \prod_{j=1}^c \exp_{i_A}(i_A o_A^{j-1}) \]
  \end{itemize}
\end{frame}

\note{ Due to the determinism of the wirings, knowing \(x\) is sufficient to determine \(x_1\). Therefore, \(x_2\) depends only on \(a_1\) and \(x\), since \(x_1\) can be determined from \(x\). }

\begin{frame}{Wiring Matrices}
  \begin{itemize}[<+->]
    \item Express each transformation as a matrix and multiply them together
    \item Easily extendable to \(n\)-partite wirings\only<.->{\footnote{If your computer has enough RAM}} and shared randomness
    \item Implemented and used to experiment with possible wirings
    \item Unfortunately not able to reduce number of extremal wirings
  \end{itemize}
\end{frame}

\subsection{A Proposed Classification}

\begin{frame}{Couplers}
  \begin{itemize}[<+->]
    \item \emph{Couplers} map \(P(\cvec{a\breve{b}b}|\cvec{x\breve{y}y}) \mapsto P'(\cvec{a\breve{b}}b'|\cvec{x\breve{y}})\)\only<.->{\footfullcite{ShortEntangleSwap}}
    \[ P'(\cvec{a\breve{b}}b'|\cvec{x\breve{y}}) = \sum_{\cvec{by}} \chi(b',\cvec{by})P(\cvec{a\breve{b}b}|\cvec{x\breve{y}y}) \]
    \item Polytope found by checking consistency of couplers on \(P(\cvec{b}|\cvec{y}) \in \NSs\)
    \item Wiring for a specific input: \emph{marginal conditional wiring} (\(\chi_{A|\lambda}(a\cvec{x}^c|\cvec{a}^cx)\) for a given \(x\))
    \item \(\#\) extremal couplers \(<\) \(\#\) extremal marginal conditional wiring distributions
    \item Could this simplify the space of wirings?
  \end{itemize}
\end{frame}

\begin{frame}{Number of Extremal Wirings}
  \begin{table}
    \begin{Tabular}{ccc} 
      \toprule
      Method & \(i = 2\) & \(i = 3\) \\
      \midrule
      Consistency on \(\NSs\) & \(82\), \(48\)  & --, \(2816\) \\
      Consistency on general behaviours & \(58\), \(512\) & --, \(524288\) \\
      No-retrocausation & \(128\), -- & \(432\), -- \\
      \bottomrule
    \end{Tabular}
    \caption{Number of extremal wirings and facets}
  \end{table}
\end{frame}

\begin{frame}{Discussion}
  \begin{itemize}[<+->]
    \item Polytope for general behaviours contained within polytope for \(\NSs\)
    \item But wirings should not care about what they act on
    \item Hypothesis: signalling makes it impossible to implement certain transformations independently
    \item Connection to recent work on LOSR transformations?\only<.->{\footfullcite{LocalTransformations}}
      \begin{itemize}
        \item Transformation is \emph{completely positive} if each party's part can be implemented while the other parties do nothing
        \item Complete positivity \(\Rightarrow\) causal
        \item Proved using signalling behaviours
      \end{itemize}
    \item May be fruitful to analyse our own definitions for wirings
  \end{itemize}
\end{frame}

\note{
  There may be a connection to recent work on LOSR transformations. In that work, 
}

\section{Key Rates}

\subsection{Wirings without Feedforward}

\begin{frame}{Simple Wirings Cannot Help}
  \begin{lemma}
                Define a \emph{wiring without feedforward} as a wiring for which all inputs generated are independent of the outputs of previous boxes, that is, a wiring \(\chi\) which obeys
                \[
                  \chi(\cvec{x}^c\cvec{y}^c|\cvec{a}^c\cvec{b}^cxy) = \chi(\cvec{x}^c\cvec{y}^c|xy).
                \]
                Make the weak assumption that operations that do not broadcast or discard information about the inputs will not impact the net cost of generating the input distribution. Then, any wiring without feedforward cannot increase the secret key capacity of a behaviour. That is, if \(p' = \chi[p^{c}]\), where \(\chi\) is a wiring without feedforward, then \(C_{\sk}^{\otimes}(p') \leq C_{\sk}^{\otimes}(p^c)\).
  \end{lemma}
\end{frame}

\begin{frame}{Proof Sketch}
  \begin{onlyenv}<1-3>
    \begin{itemize}[<+->]
      \item Wirings without feedforward obey
        \[ \chi(\cvec{x}^c\cvec{y}^c|xy) = \sum_{\lambda} P_{\Lambda}(\lambda) \chi_{A|\lambda}(\cvec{x}^c|x) \chi_{B|\lambda}(\cvec{y}^c|y) \]
      \item Measurements can generate \(\cvec{x}^c\) and \(\cvec{y}^c\) beforehand
      \item Can use same physical processes for \(p\) and \(p'\)
    \end{itemize}
  \end{onlyenv}
  \begin{onlyenv}<4->
    \begin{center}
      \includegraphics[height=0.85\textheight]{feedforward.tikz}
    \end{center}
  \end{onlyenv}
\end{frame}

\note{
  Although the AND gate was shown to increase the secret key rate for a certain protocol, we have shown that this is simply due to the key rate for that protocol on the initial behaviour not achieving the secret key capacity.
}

\begin{frame}{Discussion}
  \begin{itemize}[<+->]
    \item AND wiring is a wiring without feedforward \(\Rightarrow\) no increase in capacity
    \item Can generalise the argument about simulating the transformed statistics to other transformations
    \item Possible connection to \emph{measurement dependence}
      \begin{itemize}
        \item Measurement dependence studies correlated inputs
        \item Output dependency would correlate inputs of parties
        \item May explain why such wirings can increase capacity
      \end{itemize}
  \end{itemize}
\end{frame}

\subsection{Optimising over Wirings}

\begin{frame}{Key Rates of Extremal Wirings}
  \begin{onlyenv}<1-3>
    \begin{itemize}[<+->]
      \item \emph{Wired} secret key capacity:
        \[
            C^{W,c}_{\sk}(p) \coloneqq \sup_{\chi\in\sW_c^2} C^{\otimes}_{\sk}(\chi[p^{\otimes c}])
        \]
        \begin{theorem}
          The iid secret key capacity is convex, and therefore, for any fixed \(c\), the wired secret key capacity is maximised by extremal wirings.
        \end{theorem}
      \item Standard convexity argument: Eve can use a probabilistic mixture of implementations, and the capacity of the mixture cannot exceed the mixture of the capacities
    \end{itemize}
  \end{onlyenv}
  \begin{onlyenv}<4-6>
    \begin{itemize}[<+->]
      \item Brute force search possible, but unclear how large \(c\) needs to be
      \item Caveat: lower bounds on capacity may not be convex
      \item Other techniques for bounding capacity and optimising it over wirings not very promising
    \end{itemize}
  \end{onlyenv}
\end{frame}

\section*{Summary and Outlook}

\begin{frame}{DIQKD}
  \begin{itemize}[<+->]
    \item Proposed definition of key rate dependent on input distribution
    \item Proposed definition of secret key capacity in terms of all available classical data
  \end{itemize}
\end{frame}

\begin{frame}{Wirings}
  \begin{itemize}[<+->]
    \item Wirings generalise local operations and shared randomness
    \item Set of wirings is convex hull of deterministic wirings
    \item Implemented computational representation
    \item Next step: investigate connection to couplers and measurement dependence
  \end{itemize}
\end{frame}

\begin{frame}{Key Rates}
  \begin{itemize}[<+->]
    \item Maximised by extremal wirings
    \item Some preliminary work done but outlook not good
  \end{itemize}
\end{frame}

\begin{frame}[c]{}
  \begin{center}
    \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
      Thank you!
    \end{beamercolorbox}
  \end{center}
\end{frame}

% Placing a * after \section means it will not show in the
% outline or table of contents.

\end{document}

